<template>
  <div :id="elId" class="charts" :style="{height:height}">
  </div>
</template>

<script>
import Echarts from 'echarts'
//引入uuid文件
import uuidv1 from 'uuid/v1'
let elementResizeDetectorMaker = require("element-resize-detector");

//监听元素变化
export default {
  name: "charts",
  data () {
    return {
      elId: '',
      myChart: {},
    }
  },
  props: {
    height: String,//高度
    time: Array, //x轴的显示数据，参数名可以自己定义；
    opData: Array, //用来配置series的系列列表，参数可以自己定义；
    unit: String, //y轴单位显示，参数可以自己定义；
    title: Array
  },
  created () {
    this.elId = uuidv1() //获取随机id
    console.log("11",this.elId)
    //延迟加载，解决vue-grid-layout中echarts不显示问题
    setTimeout(() => {
      this.$nextTick(() => {
        this.$nextTick(() => {
          this.SetEchart()
        })
      })
    }, 0)
  },
  mounted () {
    //监听元素变化
    let erd = elementResizeDetectorMaker();
    let that = this;
    erd.listenTo(document.getElementById(this.elId), function (element) {
      that.$nextTick(function () {
        let myChart = that.$echarts.init(document.getElementById(that.elId));
        //使echarts尺寸重置
        myChart.resize();
      })
    })
  },
  computed: {

  },
  methods: {
    SetEchart () {
      let myChart = this.$echarts.init(document.getElementById(this.elId))
      // 绘制图表
      var option = {
        title: {
          text: '故障概率',
          left: 'center',
          textStyle: {
            fontSize: 16
          }
        },

        grid: {
          left: '3%',
          right: '4%',
          bottom: '3%',
          top: '15%',
          containLabel: true
        },
        xAxis: {
          type: 'category',
          data: [0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23,
            24,
            25,
            26,
            27,
            28,
            29,
            30,
            31,
            32,
            33,
            34,
            35,
            36,
            37,
            38,
            39,
            40,
            41,
            42,
            43,
            44,
            45,
            46,
            47,
            48,
            49,
            50,
            51,
            52,
            53,
            54,
            55,
            56,
            57,
            58,
            59,
            60,
            61,
            62,
            63,
            64,
            65,
            66,
            67,
            68,
            69,
            70,
            71,
            72,
            73,
            74,
            75,
            76,
            77,
            78,
            79,
            80,
            81,
            82,
            83,
            84,
            85,
            86,
            87,
            88,
            89,
            90,
            91,
            92,
            93,
            94,
            95,
            96,
            97,
            98,
            99,
            100,
            101,
            102,
            103,
            104,
            105,
            106,
            107,
            108,
            109,
            110,
            111,
            112,
            113,
            114,
            115,
            116,
            117,
            118,
            119,
            120,
            121,
            122]
        },
        yAxis: {
          type: 'value'
        },
        series: [{
          data: [0.0,
            0.0,
            0.0,
            2.1094237467877974e-15,
            3.5638159090467525e-14,
            3.1319391524675666e-13,
            1.8492984921181232e-12,
            8.298361997560733e-12,
            3.046307650578228e-11,
            9.592848737582926e-11,
            2.67657673802546e-10,
            6.77178313424065e-10,
            1.5802499309103268e-09,
            3.445671858948174e-09,
            7.091212950172121e-09,
            1.388456694062512e-08,
            2.6031791500180645e-08,
            4.6980925705319976e-08,
            8.197443435165042e-08,
            1.38790836601288e-07,
            2.287233842324099e-07,
            3.678519886474163e-07,
            5.786738094260002e-07,
            8.921680223483719e-07,
            1.3503813451887225e-06,
            2.009632922295168e-06,
            2.94445020720957e-06,
            4.252361557322004e-06,
            6.059686396886477e-06,
            8.528480043068498e-06,
            1.1864807649808462e-05,
            1.632854021271779e-05,
            2.2244885223177135e-05,
            3.0017885347288775e-05,
            4.0146140437569144e-05,
            5.324103122728019e-05,
            7.00477471662353e-05,
            9.146944596116757e-05,
            0.00011859489836041348,
            0.00015272999842652624,
            0.00019543354675299884,
            0.00024855774149945553,
            0.00031429383937497946,
            0.00039522347527398694,
            0.0004943761545121994,
            0.0006152934546972411,
            0.0007621004941315013,
            0.0009395852389572079,
            0.0011532862303635927,
            0.001409589314009696,
            0.0017158339438658743,
            0.0020804296088242635,
            0.0025129828889359773,
            0.0030244355844604165,
            0.003627214269642298,
            0.00433539149781903,
            0.0051648587175133764,
            0.006133510741698878,
            0.007261441334169394,
            0.008571149126115452,
            0.010087752639299175,
            0.011839212654756515,
            0.013856559511462474,
            0.016174122130395818,
            0.01882975461772196,
            0.021865055188085902,
            0.025325570847958945,
            0.02926097977468134,
            0.03372524160875423,
            0.03877670394153099,
            0.044478151134629385,
            0.05089677927279068,
            0.0581040785702619,
            0.0661756019902977,
            0.07519059630025238,
            0.0852314694155466,
            0.0963830658805751,
            0.10873172094991146,
            0.12236406329428029,
            0.13736553726268264,
            0.15381861836121014,
            0.17180070070818798,
            0.19138164329822527,
            0.2126209735851139,
            0.23556476278483873,
            0.2602422079225929,
            0.28666198132886833,
            0.3148084390391357,
            0.34463781490603884,
            0.3760745660784758,
            0.40900807588838206,
            0.4432899591576367,
            0.4787322484155907,
            0.5151067622849728,
            0.5521459631413973,
            0.5895455932542151,
            0.6269693301987349,
            0.6640556176612658,
            0.7004267034690881,
            0.7356997533119007,
            0.7694997122444098,
            0.801473369609123,
            0.8313038669829884,
            0.858724700687596,
            0.8835321428213243,
            0.9055949711071616,
            0.924860486573354,
            0.9413560255712935,
            0.9551855360365193,
            0.9665212598485845,
            0.975591090428988,
            0.982662682727118,
            0.9880257965185031,
            0.9919745747788483,
            0.9947914434345498,
            0.9967340555276265,
            0.998026230539652,
            0.9988532432749561,
            0.9993612100021421,
            0.9996598175671468,
            0.9998273309571866,
            0.9999167333734151,
            0.999961980548703],
          type: 'line',
          smooth: true
        }]
      };
      myChart.setOption(option);
    }
  }
};
</script>

<style lang="stylus" rel="stylesheet/stylus" scoped>
.bm-view
  width 100%
</style>
